"use strict";(self.webpackChunkddg=self.webpackChunkddg||[]).push([[558],{60102:(e,t,n)=>{n.d(t,{V:()=>h,A:()=>g});var r=n(13461),i=n(42895),s=n(96472),o=n(5049),l=n.n(o),a=n(49664),c=n(47044);var d=n(97284);const u=["selected","as","children","className"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const g=(0,c.s)((function(e,t){let{selected:n,as:r,children:s,className:o}=e,c=(0,i.A)(e,u);return(0,d.jsx)(a.Z,f(f({ref:t,as:r,className:l()("IRZ2AvVTFIqv1bxANKqq",{UO9wcH4caWV1iml9ftSR:n},o)},c),{},{children:s}))})),h=(0,s.forwardRef)((function({className:e,children:t,top:n,right:r,bottom:i,left:s},o){return(0,d.jsx)("div",{ref:o,className:l()("LJPgIPz9wDJEQlUjokYA",{q2Q60vvX7f0kHc3Gx3_g:n,vZ_SLtUtIm2HRLmuoqoH:r,_TGhKe0I_bkipHyx1jkc:i,g4l1w73IkDmKIN7qo7G5:s},e),children:t})}))},10560:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(96472),i=n(40356);const s={sentinel:"C4vP1bDU15qx3bGDLC9G"};var o=n(97284);function l({isActive:e,onInViewChange:t}){(0,r.useLayoutEffect)((()=>{e&&t(!0)}),[e,t]);const{ref:n}=(0,i.A)({threshold:0,initialInView:!0,onChange:e=>{t(e)}});return(0,o.jsx)("div",{className:s.sentinel,ref:n})}},87684:(e,t,n)=>{n.d(t,{A:()=>i}),n(23792),n(62953);var r=n(96472);function i(){const[e,t]=(0,r.useState)(window.matchMedia("(pointer: coarse)").matches||"ontouchstart"in window||navigator.maxTouchPoints>0);return(0,r.useEffect)((()=>{const e=window.matchMedia("(pointer: coarse)"),n=e=>t(e.matches);return"function"==typeof e.addEventListener?(e.addEventListener("change",n),()=>e.removeEventListener("change",n)):(e.addListener(n),()=>{e.removeListener(n)})}),[]),e}},89761:(e,t,n)=>{n.r(t),n.d(t,{ShoppingVertical:()=>Ae,default:()=>Se});var r=n(13461),i=(n(23792),n(3362),n(38781),n(62953),n(5049)),s=n.n(i),o=n(12100),l=n(32227),a=n(96472),c=n(39049),d=n(51720),u=n(1583),p=n(5051),f=n(94561),g=n(75855);var h=n(42334),m=n(97284);function b({className:e,extension:t}){if(null==t)return null;const{rating:n,num_reviews:r}=t,i="string"==typeof r?r:(0,h.s)(r);return(0,m.jsxs)("div",{className:s()("hf5NyDhaK2_m9xpYTMT_",e),children:[(0,m.jsx)(g.A,{rating:n}),(0,m.jsxs)(d.xL,{variant:"label",as:"span",className:"ADInVDkXEKWUklgY2vG0",children:["(",i,")"]})]})}var v=n(17517);const x={overlay:"aAiGyPGZDXoxQbl_ffxl","top-left":"O9zgHHcW1U5KzZp2C6o3","bottom-left":"fsYBXgHfzhGHD_JNhzpP"};function y({icon:e,label:t,position:n}){return(0,m.jsxs)("div",{className:s()(x.overlay,x[n]),children:[e,(0,m.jsx)(d.xL,{as:"span",variant:"label-emphasis",children:t})]})}function j({extension:e}){return null!=e&&e.text?(0,m.jsx)(y,{icon:(0,m.jsx)(v.y1,{}),label:e.text,position:"top-left"}):null}function O({extension:e}){if(null==e)return null;const t=e.text||e.long_text;return(0,m.jsx)(y,{position:"bottom-left",label:t})}function w({extension:e}){if(null==e)return null;const t=e.text||e.long_text;return(0,m.jsx)(y,{position:"top-left",icon:(0,m.jsx)(v.y1,{}),label:t})}var k=n(60102),E=n(41951),A=n(34945);const C={tile:"uWNaPtm1PpJjoVdSHeGN",imgContainer:"sbB0T4qY2HLLeqUQBQXW",fade:"OrNF9oxlNw5LHXDwozdd",brand:"yG10y4QOq199BdDVBq6e",dark:"y0CCpllGHBr3o1v_0cnB",footer:"qtYvnZepO0SbHE86P5Vy",bottom:"yKt7QkKWd7v0w4UTVgxw"},S=(0,a.forwardRef)((function({url:e,heading:t,img:n,brand:r,extensions:i,onClick:o,onHover:l,price:a,low_price:c,installmentAmount:g,onExternalLinkClick:h,externalLinkTarget:v="_blank",className:x,style:y},S){const R=(0,f.A)(),L=function(e){if(null==e)return{};const t={product_rating:e.product_rating,free_shipping:e.free_shipping,price_drop:e.price_drop};return null==t.price_drop&&(t.merchant_promotion=e.merchant_promotion),t}(i);return(0,m.jsx)(k.A,{as:"li",ref:S,onMouseEnter:l,onClick:()=>{o()},className:s()(C.tile,{[C.dark]:R},x),style:y,children:(0,m.jsxs)(E.A,{href:e,rel:"noopener",target:v,title:t,backDataId:"shopping_vertical",onClick:e=>{null==h||h(e)},children:[(0,m.jsxs)("div",{className:C.imgContainer,children:[(0,m.jsx)(p.A,{src:n,loading:"lazy",alt:t,removeOnError:!0}),(0,m.jsx)("div",{className:C.fade}),(0,m.jsx)(j,{extension:L.merchant_promotion}),(0,m.jsx)(w,{extension:L.price_drop}),(0,m.jsx)(O,{extension:L.free_shipping})]}),(0,m.jsxs)(k.V,{className:C.footer,top:!0,bottom:!0,left:!0,right:!0,children:[(0,m.jsx)(u.A,{lineClamp:2,as:"div",breakWord:!0,children:(0,m.jsx)(d.xL,{as:"h2",variant:"body-large-emphasis",linkVariant:"link-01",children:t})}),(0,m.jsx)(b,{extension:L.product_rating}),(0,m.jsxs)("div",{className:C.bottom,children:[(0,m.jsx)(A.A,{className:C.price,price:a,low_price:c,installmentAmount:g}),(0,m.jsx)(d.xL,{variant:"label-emphasis",as:"div",className:C.brand,children:(0,m.jsx)(u.A,{as:"span",inline:!1,children:r})})]})]})]})})}));var R=n(7014),L=n(58282),P=n(95840),_=n(50592),N=n(60608);const I={loadMoreWrapper:"rnUvg8bZiKMmHP4Z0YSe",infiniteScrollLoadingIndicator:"fzyJxawjxefq5iNGFVsY"};function D({nextPageUrl:e,onLoadMore:t,loading:n,hasResults:r}){const i=(0,f.A)(),s=(0,o.A)("settings",["kc"]).isDefault("kc"),l=(0,o.A)("device"),c=(0,R.KR)(),{translate:d}=(0,N.A)(),u=(0,a.useCallback)((()=>{t(s?"scroll":"click")}),[t,s]);return e?(0,m.jsx)("div",{className:I.loadMoreWrapper,children:s?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(L.G,{isLoading:n,onNext:u,pageId:e}),n&&r&&(0,m.jsx)(P.A,{className:I.infiniteScrollLoadingIndicator,size:l.is3x?"x3":l.is2x?"x2":"x1",color:i?"white":"black"})]}):(0,m.jsx)(_.A,{fullWidth:c,variant:"secondary",size:"medium",onClick:()=>{u()},disabled:n,children:n?(0,m.jsx)(P.A,{size:l.is3x?"x3":l.is2x?"x2":"x1",color:i?"white":"black"}):d("SHOW_MORE")},e)}):null}var T=n(83821),U=n(57921),q=n(28515),H=n(33541),V=n(38377);const F={header:"UWBISy7UpWcN566zTpAt",hidden:"a6qu41KKWE1Y8BX_VuOg",gone:"HAiJIuXH_D3qwoZwCxH3",sticky:"oQ3P_5LWsNOrPZc5doA1",clearAll:"v0gs6TcWPKVDu6evONrv",main:"sTWDm03nyQkNbQmSKdEB",infoIcon:"ZGNj9dk5l0VvcchI5LOw",dark:"f3DbJ04b_mDwh9XtZaFa"};function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e){const{isSticky:t,includeClearAll:n}=e,r=(0,R.KR)(),i=n||!t?(0,m.jsx)(B,K(K({},e),{},{isSticky:!1,hidden:t})):null,s=!r&&(0,T.createPortal)((0,m.jsx)(B,K(K({},e),{},{hidden:!t,gone:!n&&!t})),document.body);return(0,m.jsxs)(m.Fragment,{children:[i,s]})}function B({resultsKind:e,includeClearAll:t=!1,isSticky:n=!1,filterGroups:r=[],hidden:i=!1,gone:o=!1,onClickCapture:l}){const{translate:c}=(0,N.A)(),u=(0,R.KR)(),p=(0,f.A)(),{onFilterAction:g}=(0,H.A)({filterGroups:null!=r?r:[],onAction:W,onEngaged:()=>{}}),h=(0,q.X)(),b=(0,a.useSyncExternalStore)(h.subscribe,(()=>h.getSnapshot().isFloatingHeaderVisible)),x=c("paid"===e?"ADS":"PRODUCTS"),y=t?(0,m.jsx)("span",{className:F.clearAll,children:(0,m.jsx)(d.xL,{as:"a",role:"button",linkVariant:"interactive",onClick:()=>g({type:"CLEAR_ALL"}),children:c("CLEAR_ALL_FILTERS")})}):null;return(0,m.jsxs)("div",{className:s()(F.header,{[F.sticky]:n,[F.hidden]:i,[F.gone]:o,[F.dark]:p}),style:n&&b?{top:"101px"}:void 0,onClickCapture:l,children:[y,(0,m.jsx)("div",{className:F.main,children:(0,m.jsx)(V.y,{as:"h2",variant:"body-large-emphasis",rightContent:(0,m.jsx)(U.R9,{trigger:u?"click":"hover",button:(0,m.jsx)(v.UD,{"aria-label":"more information",className:F.infoIcon}),hasLinkStyles:!0,useMvcPanelStyles:!0,testId:"ad-badge",children:"free"===e?(0,m.jsx)(U.jl,{}):(0,m.jsx)(U.Y,{})}),children:x})})]})}function W(e){"CLEAR_ALL"===e.type&&window.location.reload()}var z=n(40356),X=n(80600);function Y(e){return"true"===String(e.free_listing)||"1"===String(e.free_listing)}var Q=n(35009);const Z={allResults:"wUznQh6YTPOEAjCVVIgH",grid:"dyEFMQsxPzAFaxXhDJfa",dark:"KTqp6F7OjYVDWqCuvHC2",dim:"WXOuooUH_7moHdtNaXow",tile:"t0Ewxqmr1faG5h3NsxHP",hl:"MQz1Y6yF_D5xAmiOsNVA",xl:"m182IS7gSvYr1n1KxDru",xxl:"HV2BERdAtZkyX5cxi46G",xxxl:"bVPUSOHoLipTe31_Kyg2",xxxxl:"R7cmxDYhaU4ZrPAuLrmS"};function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $({results:e,loadingKind:t,onGridItemsRendered:n,onItemFirstVisible:r,onItemClick:i,onExternalLinkClick:o,externalLinkTarget:l,onItemHover:c,onLoadMore:d,nextPageUrl:u,setActiveHeader:p}){const g=(0,a.useRef)(null),{width:h=0}=(0,X.o)(g,{ignoreChangesWhenElementHasNoSize:!0,useGetBoundingClientRect:!0}),{freeListings:b,paidBeforeFreeListings:v,paidAfterFreeListings:x}=(0,a.useMemo)((()=>{const t=[],n=[],r=[];let i=!1;for(const s of e)Y(s)?(t.push(s),i=!0):i?r.push(s):n.push(s);return{paidBeforeFreeListings:n,paidAfterFreeListings:r,freeListings:t}}),[e]),{fire:y}=(0,Q.A)(),j=(0,a.useRef)(new Set);(0,a.useEffect)((()=>{const e=[];x.forEach((t=>{null==t.tid||j.current.has(t.tid)||(j.current.add(t.tid),e.push(t.tid))})),e.length&&y("adreporting.shopping-ads-wrongly-outputted",{tids:encodeURIComponent(e.join(","))})}),[x,y]);const O=(0,f.A)(),w=!!t,k="filter"===t,E=v.length>0&&b.length>0,A=w||0!==e.length?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(ee,{onClick:i,variant:"paid",results:v,onRendered:n,onHover:c,onExternalLinkClick:o,externalLinkTarget:l,onItemFirstVisible:r,setActiveHeader:p,containerWidth:h,hasOwnHeader:!1,dim:k}),E&&(0,m.jsx)("hr",{}),(0,m.jsx)(ee,{onClick:i,onExternalLinkClick:o,externalLinkTarget:l,onRendered:n,variant:"free",onHover:c,onItemFirstVisible:r,results:b,containerWidth:h,hasOwnHeader:E,dim:k}),(0,m.jsx)(D,{onLoadMore:d,loading:w,nextPageUrl:u,hasResults:e.length>0})]}):null;return(0,m.jsx)("div",{ref:g,className:s()(Z.allResults,{[Z.dark]:O}),children:A})}function ee({results:e,variant:t,onClick:n,onHover:i,onRendered:o,onItemFirstVisible:l,setActiveHeader:d,hasOwnHeader:u,dim:p,onExternalLinkClick:f,externalLinkTarget:g,containerWidth:h}){const b=(0,a.useCallback)(((t,n)=>{const r=e[t];r&&(null==l||l(r,n))}),[l,e]),v=(0,a.useCallback)((t=>{null==o||o(t.map(((t,n)=>({item:e[n],visibility:t}))))}),[o,e]),x=e.length>0,y="paid"===t&&x&&!!d,j=(0,q.X)(),O=(0,a.useSyncExternalStore)(j.subscribe,(()=>j.getSnapshot().isFloatingHeaderVisible)),{ref:w}=(0,z.A)({threshold:0,initialInView:y,skip:!y,root:null,rootMargin:O?"-101px 0px 0px 0px":void 0,onChange:y?e=>d(e?"paid":"free"):void 0});if(!x)return null;const{className:k,style:E}=function(e){if(e<=0)return{className:""};function t(e,t){return Math.max(e*t-200,0)}const n=1440;if(e>=2022){const t=Math.floor((e+8)/203);return{style:{width:`calc((100% - (var(--sds-space-x02) * ${Math.max(t-1,0)})) / ${t})`}}}return e>t(n,1.35)?{className:Z.xxxxl}:e>t(n,1.25)?{className:Z.xxxl}:e>t(n,1.1)?{className:Z.xxl}:e>t(n,1)?{className:Z.xl}:e>t(1079,1.1)?{className:Z.hl}:{className:""}}(h);return(0,m.jsxs)("section",{ref:w,children:[u&&(0,m.jsx)(M,{resultsKind:t}),(0,m.jsx)(c.x,{items:e,variant:"max-cols",onChildrenRendered:v,onChildFirstVisible:b,className:s()(Z.grid,{[Z.dim]:p}),flags:{resetOnItemsChange:"paid"===t},children:(e,t,o)=>(0,m.jsx)(S,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({ref:e,onClick:()=>n(t),onHover:i?()=>i(t):void 0,onExternalLinkClick:f,externalLinkTarget:g,className:s()(Z.tile,k),style:E},t),`${t.url}_${o}`)})]})}function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e){const t=e.displayName.toLowerCase();for(const[n,r]of Object.entries(se))if(r.has(t))return n;if(CSS&&CSS.supports&&CSS.supports("color",t))return t}const ie={price:new Set(["hinta","precio","preis","prezzo","price","prijs","pris","prix"]),color:new Set(["color","colour"]),size:new Set(["größe","size","taille"]),seller:new Set(["marchand","myyjä","seller","säljaren","sælger","vendedor","venditore","verkäufer"]),brand:new Set(["brand","marke","marque"]),"sort-by":new Set([])},se=(new Set(["price","seller","brand"]),{black:new Set(["black"]),white:new Set(["white"]),red:new Set(["red"]),brown:new Set(["brown"]),blue:new Set(["blue"]),gray:new Set(["gray"]),green:new Set(["green"]),orange:new Set(["orange"]),yellow:new Set(["yellow"]),pink:new Set(["pink"]),purple:new Set(["purple"])});var oe=n(79673);function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ce(e){return{active:e.is_selected,displayName:e.display_text,resultsUrl:e.url}}function de(e,t,n){var r;const i=[];var s;t.sort_options&&t.sort_options.length&&i.push({displayName:n.sortByTranslated,filters:(null!==(s=t.sort_options)&&void 0!==s?s:[]).map(ce),ddgType:"sort-by"});for(const a of null!==(o=t.filters)&&void 0!==o?o:[]){var o;const e=Object.entries(a)[0];if(null==e)continue;const[t,n]=e;if(!t)continue;const r=n.map(ce);i.push({displayName:t,filters:r})}const l=i.map((e=>function(e){const t=e;if("sort-by"!==t.ddgType&&"price"!==t.ddgType)return t;let n=-1;for(let s=0;s<t.filters.length;s++)if(t.filters[s].active){if(-1!==n)return t;n=s}if(n<0)return t;const r="sort-by"===t.ddgType?t.filters[0].resultsUrl:t.filters[t.filters.length-1].resultsUrl,i=t.filters.slice();return i[n].resultsUrl=r,ne(ne({},t),{},{filters:i})}(function(e){const t=function(e){if(e.ddgType)return e.ddgType;for(const[t,n]of Object.entries(ie))if(n.has(e.displayName.toLowerCase()))return t}(e),n=ne(ne({},e),{},{ddgType:t});return"color"===t&&(n.filters=n.filters.map((e=>ne(ne({},e),{},{swatch:re(e)})))),n}(e))));return{adsRequestId:e,filters:l,results:(null!==(r=t.results)&&void 0!==r?r:[]).map((t=>ae(ae({},t),{},{adsRequestId:e,img:(0,oe.x)(t.img,{origin:"products"})}))),next:t.next,success:t.success}}n(48408);var ue=n(43930),pe=n(42638),fe=n(63860),ge=n(10560),he=n(42519),me=n(55238),be=n(95141),ve=n(87684),xe=n(65531),ye=n(65725),je=n(35399),Oe=n(30379);const we={shopping:"Epih0SqcNJy46aGIekdA",mobile:"DbVifGhUII2RjqPwkDZt",noResults:"_bdsnYij3RshBBXHwOXq"};function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ae({isActive:e,__storybook:t}){var n,r;const{debugVqd:i}=null!=t?t:{},c=(0,a.useRef)(new xe.IdCreator("svr-")),d=(0,q.X)(),u=(0,a.useSyncExternalStore)(d.subscribe,(()=>d.getSnapshot().query)),p=(0,o.A)("searchExperiments"),f=(0,o.A)("extension"),{getLinksURL:g}=(0,o.A)("ReactLegacyProps"),h=(0,R._6)(),[b,v]=(0,a.useState)(!1),{fire:x}=(0,Q.A)(),y=((0,o.A)("settings",["kn"]).isDefault("kn"),(0,ve.A)()),j=(0,a.useRef)(y),{translate:O}=(0,N.A)(),w=(0,a.useCallback)((e=>function(e){var t;const{next:n,query:r,vqd:i=window.vqd,ra:s=(null===(t=window.Bootstrap)||void 0===t?void 0:t.ra),shrl:o=window.shrl,isExtensionInstalled:l}=e;if(n){const[t,r]=n.split("?"),s=new URLSearchParams(r);s.set("q",e.query),s.set("vqd",i),o&&s.set("mkt",o);const l=`${t}?${s.toString()}`;return e.searchExperiments.hasActiveExperiments()?e.searchExperiments.addExperimentParameters(l):l}const a={shopping:"1",o:"json",sfexp:"1",q:r,vqd:i,ext:l?"1":void 0,a:s,mkt:o};let c=`/m.js?${new URLSearchParams(Object.entries(a).filter((([e,t])=>null!=t))).toString()}`;return e.searchExperiments.hasActiveExperiments()&&(c=e.searchExperiments.addExperimentParameters(c)),e.getLinksUrl(c)}({next:e,query:u,searchExperiments:p,vqd:i,getLinksUrl:g,isExtensionInstalled:f.isInstalled({nocache:!1})})),[u,p,i,g,f]),k=(0,a.useMemo)((()=>w()),[w]),[E,A]=(0,a.useReducer)(((e,t)=>{switch(t.type){case"ADD_PAGE_RESPONSE":{var n,r,i,s;const o=de(t.payload.adsRequestId,t.payload.mjs,{sortByTranslated:O("SORT_BY")});e.appendResults&&null!=e.response&&(o.results=e.response.results.concat(o.results),o.filters=e.response.filters);const l=e.appendResults?(null!==(n=null===(r=e.lastResponse)||void 0===r?void 0:r.pageNumber)&&void 0!==n?n:0)+1:1;return Ee(Ee({},e),{},{loadingKind:!1,error:void 0,response:o,adsConfigs:t.payload.mjs.feedback?[...e.adsConfigs,{adsRequestId:o.adsRequestId,impressionEndpoint:null===(i=t.payload.mjs.feedback)||void 0===i?void 0:i.impression,visibilityEndpoint:null===(s=t.payload.mjs.feedback)||void 0===s?void 0:s.visibility}]:e.adsConfigs,lastResponse:{pageNumber:l,count:o.results.length},adsCount:o.results.filter((e=>1!==e.free_listing)).length})}case"ERROR":{var o;let n=e.response;return null!==(o=e.response)&&void 0!==o&&o.results.length&&(n=Ee(Ee({},e.response),{},{next:""})),Ee(Ee({},e),{},{loadingKind:!1,resolvedUrl:"",response:n,error:t.payload.err,lastResponse:void 0})}case"SET_FILTER_URL":return Ee(Ee({},e),{},{resolvedUrl:w(t.payload.filterUrl),appendResults:!1});case"LOAD_NEXT_PAGE":var l;return Ee(Ee({},e),{},{error:void 0,resolvedUrl:null!==(l=e.response)&&void 0!==l&&l.next?w(e.response.next):"",appendResults:!0});case"FETCH_START":{const t=null===e.loadingKind?"initial":e.appendResults?"pagination":"filter";return Ee(Ee({},e),{},{loadingKind:t})}default:return e}}),{resolvedUrl:k,loadingKind:null,appendResults:!1,adsConfigs:[],response:void 0,adsCount:0,error:void 0}),{response:C,loadingKind:S,error:L,resolvedUrl:P}=E;(0,a.useEffect)((function(){if(!P)return;const e=new AbortController;return A({type:"FETCH_START"}),fetch(P,{signal:e.signal}).then((e=>{if(!e.ok)throw new Error(`HTTP error status: ${e.status}`);return e.json()})).then((e=>{if(!e||"object"!=typeof e)throw new Error(`Invalid non-object response: ${e}`);A({type:"ADD_PAGE_RESPONSE",payload:{adsRequestId:c.current.createId(),mjs:e}})})).catch((e=>{e&&e instanceof Error&&"AbortError"!==e.name&&A({type:"ERROR",payload:{err:e}})})),()=>{e.abort()}}),[P]);const _=(0,be.v)(),I=(0,a.useMemo)((()=>{var e;return null!==(e=null==C?void 0:C.results)&&void 0!==e?e:[]}),[C]),D=E.adsCount>0,T=(0,a.useRef)(null),U=(0,a.useCallback)((e=>{new Set(e.map((({item:e})=>e.adsRequestId))).forEach((t=>{const n=E.adsConfigs.find((e=>e.adsRequestId===t));if(n){const r=[];if(e.filter((e=>e.item.adsRequestId===t)).forEach((({item:e,visibility:t})=>{if(e&&null!=e.tid&&!Y(e)&&"unknown"!==t){const n=function(e,t){var n;return null==e.tid?null:{tid:e.tid,initialVisibility:t,extensions:Object.values(null!==(n=e.extensions)&&void 0!==n?n:{}).map((e=>({tid:e.tid,isSiteLinkExtension:!1})))}}(e,j.current?t:"none");n&&!_.hasEncounteredTid("shopping",Ce(e),e.tid)&&r.push(n)}})),r.length&&n.impressionEndpoint){const e={id:Ce({adsRequestId:t}),type:"shopping",vertical:"shopping",items:r,position:"mainline",rank:1,elementIsLikelyBlockedByAdBlocker:(0,ue.XT)(T.current)};_.onAdImpressionGroupRendered(e),_.onAllAdRequestImpressionGroupsRendered("shopping",{adsRequestId:t,impressionEndpoint:n.impressionEndpoint,visibilityEndpoint:n.visibilityEndpoint,adGroupIds:[e.id]},{preventFlush:!j.current})}}}))}),[_,E.adsConfigs]),H=(0,a.useCallback)(((e,t)=>{j.current&&(null==e.tid||Y(e)||"partial"!==t&&"full"!==t||_.onTidFirstVisible("shopping",Ce(e),e.tid,t))}),[_]),V=(0,a.useCallback)((e=>{j.current||null==e.tid||null==e.visibilityUrl||Y(e)||_.onTidFirstVisible("shopping",Ce(e),e.tid,"full",{preventFlush:!j.current})}),[_]),{fireVerticalDataFetchingError:F,fireVerticalImpression:G,fireVerticalEngagement:K,fireVerticalGridItemClick:B,fireVerticalExternalLinkClick:W,fireVerticalNextResultsReceived:z,fireVerticalLoadMoreClick:X}=(0,he.r)("shopping"),Z=(0,a.useCallback)((e=>Ee(Ee({},(0,me.C)(e,{isSideModule:!1,multipleAds:D,upstreamSource:"Bing"})),{},{vertical:"shopping"})),[D]);(0,a.useEffect)((()=>{G(e,Z)}),[G,Z,e]);const J=(0,a.useCallback)((e=>{j.current||E.adsConfigs.forEach((t=>{_.sendQueuedVisibilityReports("shopping",Ce(t),{beacon:e})}))}),[_,E.adsConfigs]);(0,a.useEffect)((()=>{!1===e&&J()}),[e,J]),(0,a.useEffect)((()=>{const e=setTimeout((()=>J()),33e5);return()=>{clearTimeout(e)}}),[J]),(0,a.useEffect)((()=>{const e=()=>{"hidden"===document.visibilityState&&(x("validate_visibility_change",{event:"visibilitychange"}),x("validate_visibility_change",{event:encodeURIComponent("visibilitychange,pagehide")}))},t=()=>{x("validate_visibility_change",{event:"pagehide"}),x("validate_visibility_change",{event:encodeURIComponent("visibilitychange,pagehide")})},n=()=>{x("validate_visibility_change",{event:"beforeunload"}),J(!0)};return window.addEventListener("visibilitychange",e),window.addEventListener("pagehide",t),window.addEventListener("beforeunload",n),()=>{window.removeEventListener("beforeunload",n),window.removeEventListener("visibilitychange",e),window.removeEventListener("pagehide",t)}}),[J,x]);const ee=(0,a.useRef)(!1),te=(0,a.useCallback)((()=>{ee.current||(ee.current=!0,K(Z))}),[K,Z]);(0,a.useEffect)((()=>{if(null==E.lastResponse)return;const{count:e,pageNumber:t}=E.lastResponse;1!==t&&z(e,t,Z)}),[E.lastResponse,z,Z]);const ne=(0,a.useCallback)((e=>{"click"===e&&X(Z),J(),A({type:"LOAD_NEXT_PAGE"})}),[J,X,Z]),re=(0,a.useCallback)((e=>{J(),B(Z,{paid:Y(e)?"0":"1"})}),[J,B,Z]),ie=(0,a.useCallback)((e=>{(0,je.A)({top:0,behavior:"smooth"}),A({type:"SET_FILTER_URL",payload:{filterUrl:e}}),v(!0),J()}),[A,J]),[se,oe]=(0,a.useState)(null),le=(0,a.useRef)(!1);(0,a.useLayoutEffect)((()=>{!le.current&&null!=I&&I[0]&&(le.current=!0,oe(Y(I[0])?"free":"paid"))}),[I]);const[ae,ce]=(0,a.useState)(!0),ke=(0,a.useCallback)((()=>{window.location.reload()}),[]),Ae=0===I.length&&(null!=L||!1===S);if((0,a.useEffect)((()=>{L&&F(Z)}),[L,F,Z]),Ae)return(0,m.jsx)(pe.A,{children:(0,m.jsx)(pe.A.Container,{children:(0,m.jsx)(pe.A.Mainline,{children:(0,m.jsx)(fe.A,{vertical:"shopping",messageI18nKey:"NO_RESULTS_FOR_PRODUCTS_QUERY",query:u,hasFilters:b,onResetFilters:ke,className:we.noResults})})})});const Se=(0,m.jsx)(ye.tH,{onError:(e,t)=>{console.error(e,t),x("jse","react_shopping_filters_error",{msg:encodeURIComponent(e.message)})},fallbackRender:Oe.A,children:(0,m.jsx)(l.C,{filters:null!==(n=null==C?void 0:C.filters)&&void 0!==n?n:[],loading:!!S,loadUrl:ie,onEngaged:()=>{},isMobile:h})}),Re=(0,m.jsx)($,{results:null!==(r=null==C?void 0:C.results)&&void 0!==r?r:[],loadingKind:S,onLoadMore:ne,onGridItemsRendered:U,onItemFirstVisible:H,onItemClick:re,onItemHover:V,nextPageUrl:null==C?void 0:C.next,setActiveHeader:e?oe:void 0,externalLinkTarget:"_blank",onExternalLinkClick:()=>{W(Z)}});return h?(0,m.jsxs)("main",{ref:T,className:s()(we.shopping,{[we.mobile]:h}),onClickCapture:te,"data-testid":"zci-products",children:[Se,!!(I.length>0&&se)&&(0,m.jsx)(M,{filterGroups:null==C?void 0:C.filters,resultsKind:se,isSticky:!1}),Re]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(ge.A,{isActive:e,onInViewChange:ce}),!!(I.length>0&&se)&&(0,m.jsx)(M,{includeClearAll:!0,onClickCapture:te,filterGroups:null==C?void 0:C.filters,resultsKind:se,isSticky:e&&!ae}),(0,m.jsxs)("main",{ref:T,className:s()(we.shopping,{[we.mobile]:h}),onClickCapture:te,"data-testid":"zci-products",children:[Se,Re]})]})}function Ce({adsRequestId:e}){return e.toString()}const Se=Ae}}]);